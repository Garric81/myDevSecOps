# myDevSecOps
Docker
Теория

Docker – это программная платформа для быстрой разработки, тестирования и развертывания приложений. Другими словами, это инструмент, который позволяет разработчикам, системным администраторам и другим специалистам разворачивать их приложения в песочницах (которые называются контейнерами), для запуска на необходимой операционной системе, например, Linux. Ключевое преимущество Docker в том, что он позволяет пользователям упаковать приложение со всеми его зависимостями в стандартизированный модуль для разработки. В отличие от виртуальных машин, контейнеры не создают высокой дополнительной нагрузки, поэтому с ними можно использовать систему и ресурсы более эффективно.

Что такое контейнер?

По сути, контейнеры — это виртуальные машины, но на более низком уровне, поэтому они потребляют меньше ресурсов по сравнению с виртуальной машиной, которую вы могли бы развернуть при помощи VirtualBox или VMWare, о которых мы поговорим дальше.
Отличие образа (image) от контейнера (container)

В инфраструктуре docker есть два важных понятия: образ (image) и контейнер (container)

Docker образ — это шаблон (физически — исполняемый пакет), из которого создаются Docker-контейнеры. Образ хранит в себе всё необходимое для запуска приложения, помещенного в контейнер: код, среду выполнения, библиотеки, переменные окружения и конфигурационные файлы.

Другими словами, docker образ – это как ведерко в детской песочнице. При помощи него создают куличики (контейнеры), а в зависимости от того, какой формы ведро, куличики (контейнеры) меняют свою форму. 

Docker-образ создаётся с помощью команды docker build, которая считывает конфигурацию создаваемого образа из специального конфигурационного файла — dockerfile.

В Dockerfile записываются команды и опции создания образа, а также некоторые настройки будущего контейнера, такие, как порты, переменные окружения и другие опции.

Каждая команда, записанная в dockerfile, создаёт свой слой. Чем больше слоёв, тем дольше будет собираться образ и дольше будет загружаться контейнер. Финальный Docker-образ — это объединение всех слоев в один. Благодаря такому подходу можно переиспользовать уже готовые образы для создания новых образов.

Контейнер — это запущенный и изолированный образ с возможностью временного сохранения данных. Данные записываются в специальный слой «сверху» контейнера и при удалении контейнера данные также удаляются.

Для работы с контейнерами Docker предоставляет всего несколько основных команд: docker run/stop/restart.


Дополнительные материалы о Docker

Лабораторная работа: введение в Docker с нуля. Ваш первый микросервис - https://habr.com/ru/articles/346634/

Руководство по Docker Compose для начинающих - https://habr.com/ru/companies/ruvds/articles/450312/
Установка для Debian 10

Для начала обновим наши репозитории:

    sudo apt update

И установим необходимые для скачивания утилиты:

    sudo apt install -y apt-transport-https ca-certificates curl software-properties-common

Далее скопируем с сайта публичный gpg-ключ:

    curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -

Добавляем директорию для скачивания docker-а:

    sudo add-apt-repository “deb [arch=amd64] https://download.docker.com/linux/ubuntu focal stable”

Далее проверяем наличие в кеше и устанавливаем Docker:

    apt-cache policy docker-ce

    apt install docker-ce

Наиболее используемые опции в контейнере Docker:

-ti – teletype (эмуляция входа в контейнер) и interactive (будем в эмуляции, пока сами не выйдем)
-e – прописать переменные окружения в /etc/hosts
-d – запустить в фоновом режиме (демоном)
--link – подключение по сети двух контейнеров, legacy функция
-p – используется для проброса портов
Наиболее используемые команды Docker:

docker pull имя образа – скачивание образа
docker ps – используется для просмотра активных контейнеров
docker run * -v /home/mount/data:/var/lib/mysql/data – примонтировать директорию на хосте в docker; в Docker Compose сначала указывается docker путь, потом хост путь
docker network ls – показать сети docker
docker network inspect [имя сети] – посмотреть конфигурацию сети
docker rm [имя] – удалить контейнер
docker rmi [имя] – удалить image
